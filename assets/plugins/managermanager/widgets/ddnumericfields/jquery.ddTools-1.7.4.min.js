/**
 * jQuery ddTools Plugin
 * @version: 1.7.4 (2012-05-04)
 * 
 * @uses jQuery 1.7.2
 *
 * @copyright Copyright 2012, DivanDesign
 * http://www.DivanDesign.ru
 */

(function(b){b.ddTools={window:b(),body:b(),windowWidth:0,windowHeight:0,objectToJSON:function(a){var c=[],d="",e="";b.isPlainObject(a)?(d="{",e="}"):b.isArray(a)&&(d="[",e="]");for(var h in a){var g=a[h],g=b.isPlainObject(g)?b.ddTools.objectToJSON(g):b.isArray(g)?b.ddTools.objectToJSON(g):'"'+g+'"';b.isPlainObject(a)?c.push('"'+h+'":'+g):b.isArray(a)&&c.push(g)}return d+c.join(",")+e},numberFormat:function(a){return a.toString().replace(/(\d)(?=(\d{3})+\D|(\d{3})+$)/g,"$1 ")},parseInt:function(a){a=
"undefined"==b.type(a)?"0":a+"";return(a=parseInt(a.replace(/[^\d-]/g,""),10))||0},parseFloat:function(a,c){a="undefined"==b.type(a)?"0":a+"";a=parseFloat(a.replace(/[^\d\-\+.,]/g,"").replace(/,/g,"."))||0;b.isNumeric(c)&&(a=parseFloat(a.toFixed(c)));return a||0},padej:function(a,b){var b=b.split(","),d=a%100;if(10<=d&&19>=d)return b[0];d=a%10;return 1==d?b[1]:1<d&&5>d?b[2]:b[0]},preloadImages:function(){var a=!1;"function"==typeof arguments[arguments.length-1]&&(a=arguments[arguments.length-1]);
var c,d,e;"object"==typeof arguments[0]?(c=arguments[0],d=c.length):(c=arguments,d=c.length-1);for(var h=d,g=0;g<=d;g++)e="object"==typeof arguments[0]?b(c[g]).attr("src"):c[g],b(new Image).load(function(){--h<1&&typeof a=="function"&&a()}).attr("src",e)},parseChunkAssoc:function(a,b,d){for(var e in b)a=a.replace(RegExp("\\[\\+"+e+"\\+\\]","gm"),b[e]);d&&(a=a.replace(/\[\+\S+\+\]/gm,""));return a},getDate:function(a){var a=b.extend({date:"",format:"d.m.y",shortFormat:"",curDate:"",lang:"ru2",lowerCase:!0},
a||{}),c=function(a){""==a?a=new Date:(a=new Date(a),b.isNumeric(a.getTime())||(a=new Date));return a},d=function(a,b){return(a+="").length<b?Array(++b-a.length).join("0")+a:a},e,h,g,i;"en"==a.lang?(e="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),h={1:"st",2:"nd",3:"rd",21:"st",22:"nd",23:"rd",31:"st"},g=" January February March April May June July August September October November December".split(" "),i=["Today","Yesterday","Day before yesterday"]):(e="\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435 \u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a \u0412\u0442\u043e\u0440\u043d\u0438\u043a \u0421\u0440\u0435\u0434\u0430 \u0427\u0435\u0442\u0432\u0435\u0440\u0433 \u041f\u044f\u0442\u043d\u0438\u0446\u0430 \u0421\u0443\u0431\u0431\u043e\u0442\u0430".split(" "),
h={1:"\u043e\u0435",2:"\u043e\u0435",3:"\u0435\u0435",21:"\u043e\u0435",22:"\u043e\u0435",23:"\u0435\u0435",31:"\u043e\u0435"},i=["\u0421\u0435\u0433\u043e\u0434\u043d\u044f","\u0412\u0447\u0435\u0440\u0430","\u041f\u043e\u0437\u0430\u0432\u0447\u0435\u0440\u0430"],g="ru"==a.lang?" \u042f\u043d\u0432\u0430\u0440\u044c \u0424\u0435\u0432\u0440\u0430\u043b\u044c \u041c\u0430\u0440\u0442 \u0410\u043f\u0440\u0435\u043b\u044c \u041c\u0430\u0439 \u0418\u044e\u043d\u044c \u0418\u044e\u043b\u044c \u0410\u0432\u0433\u0443\u0441\u0442 \u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c \u041e\u043a\u0442\u044f\u0431\u0440\u044c \u041d\u043e\u044f\u0431\u0440\u044c \u0414\u0435\u043a\u0430\u0431\u0440\u044c".split(" "):
" \u042f\u043d\u0432\u0430\u0440\u044f \u0424\u0435\u0432\u0440\u0430\u043b\u044f \u041c\u0430\u0440\u0442\u0430 \u0410\u043f\u0440\u0435\u043b\u044f \u041c\u0430\u044f \u0418\u044e\u043d\u044f \u0418\u044e\u043b\u044f \u0410\u0432\u0433\u0443\u0441\u0442\u0430 \u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044f \u041e\u043a\u0442\u044f\u0431\u0440\u044f \u041d\u043e\u044f\u0431\u0440\u044f \u0414\u0435\u043a\u0430\u0431\u0440\u044f".split(" "));a.curDate=c(a.curDate);a.date=""==a.date?a.curDate:c(a.date);
""!=a.shortFormat&&(c=a.curDate.getDate()-a.date.getDate(),1>c?a.format=a.shortFormat.replace("short",i[0]):2>c?a.format=a.shortFormat.replace("short",i[1]):3>c&&(a.format=a.shortFormat.replace("short",i[2])));var f={d:function(){return d(f.j(),2)},D:function(){t=f.l();return t.substr(0,3)},j:function(){return a.date.getDate()},l:function(){return e[f.w()]},N:function(){return f.w()+1},S:function(){return h[f.j()]?h[f.j()]:"th"},w:function(){return a.date.getDay()},z:function(){return(a.date-new Date(a.date.getFullYear()+
"/1/1"))/864E5>>0},W:function(){var b=f.z(),c=364+f.L()-b,d=((new Date(a.date.getFullYear()+"/1/1")).getDay()||7)-1;if(c<=2&&(a.date.getDay()||7)-1<=2-c)return 1;if(b<=2&&d>=4&&b>=6-d){b=new Date(a.date.getFullYear()-1+"/12/31");return date("W",Math.round(b.getTime()/1E3))}return 1+(d<=3?(b+d)/7:(b-(7-d))/7)>>0},F:function(){return g[f.n()]},m:function(){return d(f.n(),2)},M:function(){t=f.F();return t.substr(0,3)},n:function(){return a.date.getMonth()+1},t:function(){var b;return(b=a.date.getMonth()+
1)==2?28+f.L():b&1&&b<8||!(b&1)&&b>7?31:30},L:function(){var a=f.Y();return!(a&3)&&(a%100||!(a%400))?1:0},Y:function(){return a.date.getFullYear()},y:function(){return(a.date.getFullYear()+"").slice(2)},a:function(){return a.date.getHours()>11?"pm":"am"},A:function(){return f.a().toUpperCase()},B:function(){var b=(a.date.getTimezoneOffset()+60)*60,b=a.date.getHours()*3600+a.date.getMinutes()*60+a.date.getSeconds()+b,b=Math.floor(b/86.4);b>1E3&&(b=b-1E3);b<0&&(b=b+1E3);(""+b).length==1&&(b="00"+b);
(""+b).length==2&&(b="0"+b);return b},g:function(){return a.date.getHours()%12||12},G:function(){return a.date.getHours()},h:function(){return d(f.g(),2)},H:function(){return d(a.date.getHours(),2)},i:function(){return d(a.date.getMinutes(),2)},s:function(){return d(a.date.getSeconds(),2)},O:function(){var b=d(Math.abs(a.date.getTimezoneOffset()/60*100),4);return b=a.date.getTimezoneOffset()>0?"-"+b:"+"+b},P:function(){var a=f.O();return a.substr(0,3)+":"+a.substr(3,2)},c:function(){return f.Y()+
"-"+f.m()+"-"+f.d()+"T"+f.h()+":"+f.i()+":"+f.s()+f.P()},U:function(){return Math.round(a.date.getTime()/1E3)}};i=a.format.replace(/[\\]?([a-zA-Z])/g,function(a,b){return a!=b?b:f[b]?f[b]():b});a.lowerCase&&(i=i.toLowerCase());return i}};b.fn.ddGetRealImageSize=function(){var a=b(this).eq(0).clone().appendTo(b.ddTools.body).hide();if(0<a.length){a.removeAttr("width");a.removeAttr("height");a.attr("style","width: auto !important; height: auto !important;");var c={width:a.width(),height:a.height()};
a.remove();return c}};b.ddCookieForm={defaults:{cookieName:!1,data:!1,fieldsSelector:'input[type="text"]',cookieOpt:{expires:365,path:"/"},writeEmptyVal:!0},cookieToObj:function(a){var c;if(a.cookieName)if(b.cookie(a.cookieName))try{c=b.parseJSON(b.cookie(a.cookieName))}catch(d){c=!1}else b.cookie(a.cookieName,"",a.cookieOpt),c=!1;else c=!1;return c}};b.fn.ddFormToCookie=function(a){var a=b.extend({},b.ddCookieForm.defaults,a),c=b.ddCookieForm.cookieToObj(a);c||(c={});b(this).each(function(){b(this).find(a.fieldsSelector).each(function(){var d=
b(this),e=d.val();if(a.writeEmptyVal||""!=e)c[d.attr("name")]=e})});a.cookieName&&b.cookie(a.cookieName,b.ddTools.objectToJSON(c),a.cookieOpt);return c};b.fn.ddCookieToForm=function(a){var a=b.extend({},b.ddCookieForm.defaults,a),c=b.ddCookieForm.cookieToObj(a);if(!c)if(a.data)c=a.data;else return;return b(this).each(function(){var d=b(this).find(a.fieldsSelector),e;for(e in c){var h=d.filter("[name="+e+"]");0<h.length&&(a.writeEmptyVal||""!=c[e])&&h.val(c[e])}})};b.fn.ddMaxLength=function(a){var a=
b.extend({},{max:150,containerSelector:!1,parentSelector:!1,suffixSelector:!1,suffix:"\u043e\u0432,,\u0430",errorClass:"maxLengthError",warningClass:"maxLengthError",canWriteError:!0,minProcent:7},a),c=a.max/100*a.minProcent,d=function(d,h,g){h=a.max-h;0>h||h<c?d.removeClass(a.warningClass).addClass(a.errorClass):h<2*c?d.removeClass(a.errorClass).addClass(a.warningClass):d.removeClass(a.warningClass).removeClass(a.errorClass);d.text(h);g&&g.text(b.ddTools.padej(h,a.suffix))};return b(this).each(function(){var c=
b(this),h=c.val();if(a.containerSelector){var g;g=a.parentSelector?c.parents(a.parentSelector+":first"):c.parent();var i=g.find(a.containerSelector),f;a.suffixSelector&&(f=g.find(a.suffixSelector))}i&&d(i,h.length,f);a.canWriteError||c.val(h.substring(0,a.max));c.on("keyup",function(){var c=b(this),e=c.val();if(!a.canWriteError&&e.length>a.max)return c.val(e.substring(0,a.max)),!1;i&&d(i,e.length,f);return!0})})};b.fn.ddFormWithPlaceholders=function(a){a=b.extend({placeholderSelector:"label"},a||
{});return b(this).each(function(){var c=b(this);b(a.placeholderSelector,c).on("click",function(){b(this).prev("input, textarea").trigger("focus")});b('input[type="text"], input[type="password"], textarea').on("focus",function(){b(this).next(a.placeholderSelector,c).hide()}).on("blur",function(){""==b.trim(b(this).val())?b(this).next(a.placeholderSelector,c).show():b(this).next(a.placeholderSelector,c).hide()}).trigger("blur")})};b.fn.ddFixed=function(a){a=b.extend({fixedClass:"fixed"},a||{});return b(this).each(function(){var a=
b(this),d=a.offset().top,e=b("<div></div>");b.ddTools.window.on("resize",function(){e.css({width:a.outerWidth(!0),height:a.outerHeight(!0)})}).trigger("resize");b.ddTools.window.on("scroll load",function(){b.ddTools.window.scrollTop()>=d?(a.addClass("fixed"),e.insertAfter(a)):(a.removeClass("fixed"),e.remove())})})};b.fn.ddActiveScroll=function(a){a=b.extend({distance:50,event:"click"},a||{});return b(this).each(function(){var c=b(this);b.ddTools.window.on("scroll load",function(){b.ddTools.window.scrollTop()+
b.ddTools.windowHeight+a.distance>=c.offset().top&&c.trigger(a.event)})})};b(function(){b.ddTools.window=b(window);b.ddTools.body=b("body");b.ddTools.window.on("resize",function(){b.ddTools.windowWidth=b.ddTools.window.width();b.ddTools.windowHeight=b.ddTools.window.height()}).trigger("resize")})})(jQuery);